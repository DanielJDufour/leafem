!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).flatgeobuf={})}(this,function(t){"use strict";var e={SIZEOF_SHORT:2,SIZEOF_INT:4,FILE_IDENTIFIER_LENGTH:4,Encoding:{UTF8_BYTES:1,UTF16_STRING:2}};e.int32=new Int32Array(2),e.float32=new Float32Array(e.int32.buffer),e.float64=new Float64Array(e.int32.buffer),e.isLittleEndian=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0],e.Long=function(t,e){this.low=0|t,this.high=0|e},e.Long.create=function(t,r){return 0==t&&0==r?e.Long.ZERO:new e.Long(t,r)},e.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},e.Long.prototype.equals=function(t){return this.low==t.low&&this.high==t.high},e.Long.ZERO=new e.Long(0,0),e.Builder=function(t){if(t)r=t;else var r=1024;this.bb=e.ByteBuffer.allocate(r),this.space=r,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},e.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},e.Builder.prototype.forceDefaults=function(t){this.force_defaults=t},e.Builder.prototype.dataBuffer=function(){return this.bb},e.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},e.Builder.prototype.prep=function(t,r){t>this.minalign&&(this.minalign=t);for(var i=1+~(this.bb.capacity()-this.space+r)&t-1;this.space<i+t+r;){var s=this.bb.capacity();this.bb=e.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-s}this.pad(i)},e.Builder.prototype.pad=function(t){for(var e=0;e<t;e++)this.bb.writeInt8(--this.space,0)},e.Builder.prototype.writeInt8=function(t){this.bb.writeInt8(this.space-=1,t)},e.Builder.prototype.writeInt16=function(t){this.bb.writeInt16(this.space-=2,t)},e.Builder.prototype.writeInt32=function(t){this.bb.writeInt32(this.space-=4,t)},e.Builder.prototype.writeInt64=function(t){this.bb.writeInt64(this.space-=8,t)},e.Builder.prototype.writeFloat32=function(t){this.bb.writeFloat32(this.space-=4,t)},e.Builder.prototype.writeFloat64=function(t){this.bb.writeFloat64(this.space-=8,t)},e.Builder.prototype.addInt8=function(t){this.prep(1,0),this.writeInt8(t)},e.Builder.prototype.addInt16=function(t){this.prep(2,0),this.writeInt16(t)},e.Builder.prototype.addInt32=function(t){this.prep(4,0),this.writeInt32(t)},e.Builder.prototype.addInt64=function(t){this.prep(8,0),this.writeInt64(t)},e.Builder.prototype.addFloat32=function(t){this.prep(4,0),this.writeFloat32(t)},e.Builder.prototype.addFloat64=function(t){this.prep(8,0),this.writeFloat64(t)},e.Builder.prototype.addFieldInt8=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt8(e),this.slot(t))},e.Builder.prototype.addFieldInt16=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt16(e),this.slot(t))},e.Builder.prototype.addFieldInt32=function(t,e,r){(this.force_defaults||e!=r)&&(this.addInt32(e),this.slot(t))},e.Builder.prototype.addFieldInt64=function(t,e,r){!this.force_defaults&&e.equals(r)||(this.addInt64(e),this.slot(t))},e.Builder.prototype.addFieldFloat32=function(t,e,r){(this.force_defaults||e!=r)&&(this.addFloat32(e),this.slot(t))},e.Builder.prototype.addFieldFloat64=function(t,e,r){(this.force_defaults||e!=r)&&(this.addFloat64(e),this.slot(t))},e.Builder.prototype.addFieldOffset=function(t,e,r){(this.force_defaults||e!=r)&&(this.addOffset(e),this.slot(t))},e.Builder.prototype.addFieldStruct=function(t,e,r){e!=r&&(this.nested(e),this.slot(t))},e.Builder.prototype.nested=function(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},e.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},e.Builder.prototype.slot=function(t){this.vtable[t]=this.offset()},e.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},e.Builder.growByteBuffer=function(t){var r=t.capacity();if(3221225472&r)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var i=r<<1,s=e.ByteBuffer.allocate(i);return s.setPosition(i-r),s.bytes().set(t.bytes(),i-r),s},e.Builder.prototype.addOffset=function(t){this.prep(e.SIZEOF_INT,0),this.writeInt32(this.offset()-t+e.SIZEOF_INT)},e.Builder.prototype.startObject=function(t){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=t;for(var e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()},e.Builder.prototype.endObject=function(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var t=this.offset(),r=this.vtable_in_use-1;r>=0&&0==this.vtable[r];r--);for(var i=r+1;r>=0;r--)this.addInt16(0!=this.vtable[r]?t-this.vtable[r]:0);this.addInt16(t-this.object_start);var s=(i+2)*e.SIZEOF_SHORT;this.addInt16(s);var n=0,o=this.space;t:for(r=0;r<this.vtables.length;r++){var a=this.bb.capacity()-this.vtables[r];if(s==this.bb.readInt16(a)){for(var b=e.SIZEOF_SHORT;b<s;b+=e.SIZEOF_SHORT)if(this.bb.readInt16(o+b)!=this.bb.readInt16(a+b))continue t;n=this.vtables[r];break}}return n?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,n-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t},e.Builder.prototype.finish=function(t,r){if(r){var i=r;if(this.prep(this.minalign,e.SIZEOF_INT+e.FILE_IDENTIFIER_LENGTH),i.length!=e.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+e.FILE_IDENTIFIER_LENGTH);for(var s=e.FILE_IDENTIFIER_LENGTH-1;s>=0;s--)this.writeInt8(i.charCodeAt(s))}this.prep(this.minalign,e.SIZEOF_INT),this.addOffset(t),this.bb.setPosition(this.space)},e.Builder.prototype.requiredField=function(t,e){var r=this.bb.capacity()-t,i=r-this.bb.readInt32(r);if(!(0!=this.bb.readInt16(i+e)))throw new Error("FlatBuffers: field "+e+" must be set")},e.Builder.prototype.startVector=function(t,r,i){this.notNested(),this.vector_num_elems=r,this.prep(e.SIZEOF_INT,t*r),this.prep(i,t*r)},e.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},e.Builder.prototype.createString=function(t){if(t instanceof Uint8Array)var e=t;else{e=[];for(var r=0;r<t.length;){var i,s=t.charCodeAt(r++);if(s<55296||s>=56320)i=s;else i=(s<<10)+t.charCodeAt(r++)+-56613888;i<128?e.push(i):(i<2048?e.push(i>>6&31|192):(i<65536?e.push(i>>12&15|224):e.push(i>>18&7|240,i>>12&63|128),e.push(i>>6&63|128)),e.push(63&i|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);r=0;for(var n=this.space,o=this.bb.bytes();r<e.length;r++)o[n++]=e[r];return this.endVector()},e.Builder.prototype.createLong=function(t,r){return e.Long.create(t,r)},e.ByteBuffer=function(t){this.bytes_=t,this.position_=0},e.ByteBuffer.allocate=function(t){return new e.ByteBuffer(new Uint8Array(t))},e.ByteBuffer.prototype.clear=function(){this.position_=0},e.ByteBuffer.prototype.bytes=function(){return this.bytes_},e.ByteBuffer.prototype.position=function(){return this.position_},e.ByteBuffer.prototype.setPosition=function(t){this.position_=t},e.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},e.ByteBuffer.prototype.readInt8=function(t){return this.readUint8(t)<<24>>24},e.ByteBuffer.prototype.readUint8=function(t){return this.bytes_[t]},e.ByteBuffer.prototype.readInt16=function(t){return this.readUint16(t)<<16>>16},e.ByteBuffer.prototype.readUint16=function(t){return this.bytes_[t]|this.bytes_[t+1]<<8},e.ByteBuffer.prototype.readInt32=function(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24},e.ByteBuffer.prototype.readUint32=function(t){return this.readInt32(t)>>>0},e.ByteBuffer.prototype.readInt64=function(t){return new e.Long(this.readInt32(t),this.readInt32(t+4))},e.ByteBuffer.prototype.readUint64=function(t){return new e.Long(this.readUint32(t),this.readUint32(t+4))},e.ByteBuffer.prototype.readFloat32=function(t){return e.int32[0]=this.readInt32(t),e.float32[0]},e.ByteBuffer.prototype.readFloat64=function(t){return e.int32[e.isLittleEndian?0:1]=this.readInt32(t),e.int32[e.isLittleEndian?1:0]=this.readInt32(t+4),e.float64[0]},e.ByteBuffer.prototype.writeInt8=function(t,e){this.bytes_[t]=e},e.ByteBuffer.prototype.writeUint8=function(t,e){this.bytes_[t]=e},e.ByteBuffer.prototype.writeInt16=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8},e.ByteBuffer.prototype.writeUint16=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8},e.ByteBuffer.prototype.writeInt32=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24},e.ByteBuffer.prototype.writeUint32=function(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24},e.ByteBuffer.prototype.writeInt64=function(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)},e.ByteBuffer.prototype.writeUint64=function(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)},e.ByteBuffer.prototype.writeFloat32=function(t,r){e.float32[0]=r,this.writeInt32(t,e.int32[0])},e.ByteBuffer.prototype.writeFloat64=function(t,r){e.float64[0]=r,this.writeInt32(t,e.int32[e.isLittleEndian?0:1]),this.writeInt32(t+4,e.int32[e.isLittleEndian?1:0])},e.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+e.SIZEOF_INT+e.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var t="",r=0;r<e.FILE_IDENTIFIER_LENGTH;r++)t+=String.fromCharCode(this.readInt8(this.position_+e.SIZEOF_INT+r));return t},e.ByteBuffer.prototype.__offset=function(t,e){var r=t-this.readInt32(t);return e<this.readInt16(r)?this.readInt16(r+e):0},e.ByteBuffer.prototype.__union=function(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t},e.ByteBuffer.prototype.__string=function(t,r){t+=this.readInt32(t);var i=this.readInt32(t),s="",n=0;if(t+=e.SIZEOF_INT,r===e.Encoding.UTF8_BYTES)return this.bytes_.subarray(t,t+i);for(;n<i;){var o,a=this.readUint8(t+n++);if(a<192)o=a;else{var b=this.readUint8(t+n++);if(a<224)o=(31&a)<<6|63&b;else{var h=this.readUint8(t+n++);if(a<240)o=(15&a)<<12|(63&b)<<6|63&h;else o=(7&a)<<18|(63&b)<<12|(63&h)<<6|63&this.readUint8(t+n++)}}o<65536?s+=String.fromCharCode(o):(o-=65536,s+=String.fromCharCode(55296+(o>>10),56320+(1023&o)))}return s},e.ByteBuffer.prototype.__indirect=function(t){return t+this.readInt32(t)},e.ByteBuffer.prototype.__vector=function(t){return t+this.readInt32(t)+e.SIZEOF_INT},e.ByteBuffer.prototype.__vector_len=function(t){return this.readInt32(t+this.readInt32(t))},e.ByteBuffer.prototype.__has_identifier=function(t){if(t.length!=e.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+e.FILE_IDENTIFIER_LENGTH);for(var r=0;r<e.FILE_IDENTIFIER_LENGTH;r++)if(t.charCodeAt(r)!=this.readInt8(this.position_+e.SIZEOF_INT+r))return!1;return!0},e.ByteBuffer.prototype.createLong=function(t,r){return e.Long.create(t,r)};var r,i=new Uint8Array(0);function s(t,e){if(!t.length)return e;if(!e.length)return t;var r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function n(t){this._source=t,this._array=i,this._index=0}n.prototype.read=function(){var t=this,e=t._array.subarray(t._index);return t._source.read().then(function(r){return t._array=i,t._index=0,r.done?e.length>0?{done:!1,value:e}:{done:!0,value:void 0}:{done:!1,value:s(e,r.value)}})},n.prototype.slice=function(t){if((t|=0)<0)throw new Error("invalid length");var e=this,r=this._array.length-this._index;if(this._index+t<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=t));var s=new Uint8Array(t);return s.set(this._array.subarray(this._index)),function n(){return e._source.read().then(function(o){return o.done?(e._array=i,e._index=0,r>0?s.subarray(0,r):null):r+o.value.length>=t?(e._array=o.value,e._index=t-r,s.set(o.value.subarray(0,t-r),r),s):(s.set(o.value,r),r+=o.value.length,n())})}()},n.prototype.cancel=function(){return this._source.cancel()};class o{constructor(t,e){this.name=t,this.type=e}}!function(t){t[t.Byte=0]="Byte",t[t.UByte=1]="UByte",t[t.Bool=2]="Bool",t[t.Short=3]="Short",t[t.UShort=4]="UShort",t[t.Int=5]="Int",t[t.UInt=6]="UInt",t[t.Long=7]="Long",t[t.ULong=8]="ULong",t[t.Float=9]="Float",t[t.Double=10]="Double",t[t.String=11]="String",t[t.Json=12]="Json",t[t.DateTime=13]="DateTime",t[t.Binary=14]="Binary"}(r||(r={}));var a,b,h,u,d=r;!function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon",t[t.MultiPoint=4]="MultiPoint",t[t.MultiLineString=5]="MultiLineString",t[t.MultiPolygon=6]="MultiPolygon",t[t.GeometryCollection=7]="GeometryCollection",t[t.CircularString=8]="CircularString",t[t.CompoundCurve=9]="CompoundCurve",t[t.CurvePolygon=10]="CurvePolygon",t[t.MultiCurve=11]="MultiCurve",t[t.MultiSurface=12]="MultiSurface",t[t.Curve=13]="Curve",t[t.Surface=14]="Surface",t[t.PolyhedralSurface=15]="PolyhedralSurface",t[t.TIN=16]="TIN",t[t.Triangle=17]="Triangle"}(a||(a={})),function(t){t[t.Byte=0]="Byte",t[t.UByte=1]="UByte",t[t.Bool=2]="Bool",t[t.Short=3]="Short",t[t.UShort=4]="UShort",t[t.Int=5]="Int",t[t.UInt=6]="UInt",t[t.Long=7]="Long",t[t.ULong=8]="ULong",t[t.Float=9]="Float",t[t.Double=10]="Double",t[t.String=11]="String",t[t.Json=12]="Json",t[t.DateTime=13]="DateTime",t[t.Binary=14]="Binary"}(b||(b={}));class f{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new f).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return(e||new f).__init(t.readInt32(t.position())+t.position(),t)}name(t){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}type(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):b.Byte}static start(t){t.startObject(2)}static addName(t,e){t.addFieldOffset(0,e,0)}static addType(t,e){t.addFieldInt8(1,e,b.Byte)}static end(t){var e=t.endObject();return t.requiredField(e,4),e}static create(t,e,r){return f.start(t),f.addName(t,e),f.addType(t,r),f.end(t)}}class c{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new c).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return(e||new c).__init(t.readInt32(t.position())+t.position(),t)}org(t){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}code(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}name(t){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}wkt(t){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__string(this.bb_pos+e,t):null}static start(t){t.startObject(5)}static addOrg(t,e){t.addFieldOffset(0,e,0)}static addCode(t,e){t.addFieldInt32(1,e,0)}static addName(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWkt(t,e){t.addFieldOffset(4,e,0)}static end(t){return t.endObject()}static create(t,e,r,i,s,n){return c.start(t),c.addOrg(t,e),c.addCode(t,r),c.addName(t,i),c.addDescription(t,s),c.addWkt(t,n),c.end(t)}}class l{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new l).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return(e||new l).__init(t.readInt32(t.position())+t.position(),t)}name(t){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}envelope(t){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}envelopeLength(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}envelopeArray(){var t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}geometryType(){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):a.Unknown}hasZ(){var t=this.bb.__offset(this.bb_pos,10);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasM(){var t=this.bb.__offset(this.bb_pos,12);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasT(){var t=this.bb.__offset(this.bb_pos,14);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasTM(){var t=this.bb.__offset(this.bb_pos,16);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}columns(t,e){var r=this.bb.__offset(this.bb_pos,18);return r?(e||new f).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}columnsLength(){var t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}featuresCount(){var t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readUint64(this.bb_pos+t):this.bb.createLong(0,0)}indexNodeSize(){var t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readUint16(this.bb_pos+t):16}crs(t){var e=this.bb.__offset(this.bb_pos,24);return e?(t||new c).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static start(t){t.startObject(11)}static addName(t,e){t.addFieldOffset(0,e,0)}static addEnvelope(t,e){t.addFieldOffset(1,e,0)}static createEnvelopeVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startEnvelopeVector(t,e){t.startVector(8,e,8)}static addGeometryType(t,e){t.addFieldInt8(2,e,a.Unknown)}static addHasZ(t,e){t.addFieldInt8(3,+e,0)}static addHasM(t,e){t.addFieldInt8(4,+e,0)}static addHasT(t,e){t.addFieldInt8(5,+e,0)}static addHasTM(t,e){t.addFieldInt8(6,+e,0)}static addColumns(t,e){t.addFieldOffset(7,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(var r=e.length-1;r>=0;r--)t.addOffset(e[r]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static addFeaturesCount(t,e){t.addFieldInt64(8,e,t.createLong(0,0))}static addIndexNodeSize(t,e){t.addFieldInt16(9,e,16)}static addCrs(t,e){t.addFieldOffset(10,e,0)}static end(t){return t.endObject()}static finishBuffer(t,e){t.finish(e)}static finishSizePrefixedBuffer(t,e){t.finish(e,void 0,!0)}static create(t,e,r,i,s,n,o,a,b,h,u,d){return l.start(t),l.addName(t,e),l.addEnvelope(t,r),l.addGeometryType(t,i),l.addHasZ(t,s),l.addHasM(t,n),l.addHasT(t,o),l.addHasTM(t,a),l.addColumns(t,b),l.addFeaturesCount(t,h),l.addIndexNodeSize(t,u),l.addCrs(t,d),l.end(t)}}!function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon",t[t.MultiPoint=4]="MultiPoint",t[t.MultiLineString=5]="MultiLineString",t[t.MultiPolygon=6]="MultiPolygon",t[t.GeometryCollection=7]="GeometryCollection",t[t.CircularString=8]="CircularString",t[t.CompoundCurve=9]="CompoundCurve",t[t.CurvePolygon=10]="CurvePolygon",t[t.MultiCurve=11]="MultiCurve",t[t.MultiSurface=12]="MultiSurface",t[t.Curve=13]="Curve",t[t.Surface=14]="Surface",t[t.PolyhedralSurface=15]="PolyhedralSurface",t[t.TIN=16]="TIN",t[t.Triangle=17]="Triangle"}(h||(h={})),function(t){t[t.Byte=0]="Byte",t[t.UByte=1]="UByte",t[t.Bool=2]="Bool",t[t.Short=3]="Short",t[t.UShort=4]="UShort",t[t.Int=5]="Int",t[t.UInt=6]="UInt",t[t.Long=7]="Long",t[t.ULong=8]="ULong",t[t.Float=9]="Float",t[t.Double=10]="Double",t[t.String=11]="String",t[t.Json=12]="Json",t[t.DateTime=13]="DateTime",t[t.Binary=14]="Binary"}(u||(u={}));class _{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new _).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return(e||new _).__init(t.readInt32(t.position())+t.position(),t)}name(t){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}type(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):u.Byte}static start(t){t.startObject(2)}static addName(t,e){t.addFieldOffset(0,e,0)}static addType(t,e){t.addFieldInt8(1,e,u.Byte)}static end(t){var e=t.endObject();return t.requiredField(e,4),e}static create(t,e,r){return _.start(t),_.addName(t,e),_.addType(t,r),_.end(t)}}class p{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new p).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return(e||new p).__init(t.readInt32(t.position())+t.position(),t)}ends(t){var e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+4*t):0}endsLength(){var t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}endsArray(){var t=this.bb.__offset(this.bb_pos,4);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}xy(t){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}xyLength(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}xyArray(){var t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}z(t){var e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}zLength(){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}zArray(){var t=this.bb.__offset(this.bb_pos,8);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}m(t){var e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}mLength(){var t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}mArray(){var t=this.bb.__offset(this.bb_pos,10);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}t(t){var e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}tLength(){var t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}tArray(){var t=this.bb.__offset(this.bb_pos,12);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}tm(t){var e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint64(this.bb.__vector(this.bb_pos+e)+8*t):this.bb.createLong(0,0)}tmLength(){var t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}type(){var t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readUint8(this.bb_pos+t):h.Unknown}parts(t,e){var r=this.bb.__offset(this.bb_pos,18);return r?(e||new p).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}partsLength(){var t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static start(t){t.startObject(8)}static addEnds(t,e){t.addFieldOffset(0,e,0)}static createEndsVector(t,e){t.startVector(4,e.length,4);for(var r=e.length-1;r>=0;r--)t.addInt32(e[r]);return t.endVector()}static startEndsVector(t,e){t.startVector(4,e,4)}static addXy(t,e){t.addFieldOffset(1,e,0)}static createXyVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startXyVector(t,e){t.startVector(8,e,8)}static addZ(t,e){t.addFieldOffset(2,e,0)}static createZVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startZVector(t,e){t.startVector(8,e,8)}static addM(t,e){t.addFieldOffset(3,e,0)}static createMVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startMVector(t,e){t.startVector(8,e,8)}static addT(t,e){t.addFieldOffset(4,e,0)}static createTVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startTVector(t,e){t.startVector(8,e,8)}static addTm(t,e){t.addFieldOffset(5,e,0)}static createTmVector(t,e){t.startVector(8,e.length,8);for(var r=e.length-1;r>=0;r--)t.addInt64(e[r]);return t.endVector()}static startTmVector(t,e){t.startVector(8,e,8)}static addType(t,e){t.addFieldInt8(6,e,h.Unknown)}static addParts(t,e){t.addFieldOffset(7,e,0)}static createPartsVector(t,e){t.startVector(4,e.length,4);for(var r=e.length-1;r>=0;r--)t.addOffset(e[r]);return t.endVector()}static startPartsVector(t,e){t.startVector(4,e,4)}static end(t){return t.endObject()}static create(t,e,r,i,s,n,o,a,b){return p.start(t),p.addEnds(t,e),p.addXy(t,r),p.addZ(t,i),p.addM(t,s),p.addT(t,n),p.addTm(t,o),p.addType(t,a),p.addParts(t,b),p.end(t)}}class y{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRoot(t,e){return(e||new y).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRoot(t,e){return(e||new y).__init(t.readInt32(t.position())+t.position(),t)}geometry(t){var e=this.bb.__offset(this.bb_pos,4);return e?(t||new p).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}properties(t){var e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}propertiesLength(){var t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}propertiesArray(){var t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}columns(t,e){var r=this.bb.__offset(this.bb_pos,8);return r?(e||new _).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}columnsLength(){var t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}static start(t){t.startObject(3)}static addGeometry(t,e){t.addFieldOffset(0,e,0)}static addProperties(t,e){t.addFieldOffset(1,e,0)}static createPropertiesVector(t,e){t.startVector(1,e.length,1);for(var r=e.length-1;r>=0;r--)t.addInt8(e[r]);return t.endVector()}static startPropertiesVector(t,e){t.startVector(1,e,1)}static addColumns(t,e){t.addFieldOffset(2,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(var r=e.length-1;r>=0;r--)t.addOffset(e[r]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static end(t){return t.endObject()}static finishBuffer(t,e){t.finish(e)}static finishSizePrefixedBuffer(t,e){t.finish(e,void 0,!0)}static create(t,e,r,i){return y.start(t),y.addGeometry(t,e),y.addProperties(t,r),y.addColumns(t,i),y.end(t)}}class g{constructor(t,e){this.geometryType=t,this.columns=e}}function I(t){return t.reduce((t,e)=>Array.isArray(e)?t.concat(I(e)):t.concat(e),[])}function v(t){const e=[];for(let r=0;r<t.length;r+=2)e.push([t[r],t[r+1]]);return e}function B(t){return a[t]}function w(t){const e=t.coordinates;let r=null,i=null,s=null,n=B(t.type),o=0;switch(t.type){case"Point":r=e;break;case"MultiPoint":case"LineString":r=I(e);break;case"MultiLineString":case"Polygon":const n=e;r=I(n),n.length>1&&(i=n.map(t=>o+=t.length));break;case"MultiPolygon":s=e.map(t=>({type:"Polygon",coordinates:t})).map(w);break;case"GeometryCollection":s=t.geometries.map(w)}return{xy:r,ends:i,type:n,parts:s}}function F(t,e){if(!e||0===e.length)return[v(t)];let r=0;return Array.from(e).map(e=>t.slice(r,r=e<<1)).map(t=>v(t))}function m(t,e){if(e==a.GeometryCollection){const r=[];for(let e=0;e<t.partsLength();e++){const i=t.parts(e),s=i.type();r.push(m(i,s))}return{type:a[e],geometries:r}}if(e==a.MultiPolygon){const r=[];for(let e=0;e<t.partsLength();e++){const i=t.parts(e),s=i.type();r.push(m(i,s))}return{type:a[e],coordinates:r.map(t=>t.coordinates)}}const r=function(t,e){const r=t.xyArray();switch(e){case a.Point:return Array.from(r);case a.MultiPoint:case a.LineString:return v(r);case a.MultiLineString:case a.Polygon:return F(r,t.endsArray())}}(t,e);return{type:a[e],coordinates:r}}function E(t,r){const i=r.columns,s=new e.Builder(0),n=new Uint8Array(1e5);let o=0;if(i){const e=new DataView(n.buffer);for(let r=0;r<i.length;r++){const s=i[r],a=t.properties[s.name];if(null!==a)switch(e.setUint16(o,r,!0),o+=2,s.type){case d.Bool:e.setUint8(o,a),o+=1;break;case d.Short:e.setInt16(o,a,!0),o+=2;break;case d.UShort:e.setUint16(o,a,!0),o+=2;break;case d.Int:e.setInt32(o,a,!0),o+=4;break;case d.UInt:e.setUint32(o,a,!0),o+=4;break;case d.Long:e.setBigInt64(o,BigInt(a),!0),o+=8;break;case d.Long:e.setBigUint64(o,BigInt(a),!0),o+=8;break;case d.Double:e.setFloat64(o,a,!0),o+=8;break;case d.String:const t=a,i=(new TextEncoder).encode(t);e.setUint32(o,i.length,!0),o+=4,n.set(i,o),o+=i.length;break;default:throw new Error("Unknown type")}}}let a=null;o>0&&(a=y.createPropertiesVector(s,n.slice(0,o)));const b=function t(e,r){const{xy:i,ends:s,parts:n,type:o}=r;if(n){const r=n.map(r=>t(e,r)),i=p.createPartsVector(e,r);return p.start(e),p.addParts(e,i),p.end(e)}const a=p.createXyVector(e,i);let b=null;return s&&(b=p.createEndsVector(e,s)),p.start(e),b&&p.addEnds(e,b),p.addXy(e,a),p.addType(e,o),p.end(e)}(s,w(t.geometry));y.start(s),y.addGeometry(s,b),a&&y.addProperties(s,a);const h=y.end(s);return s.finishSizePrefixed(h),s.asUint8Array()}function S(t,e){const r=e.columns;let i;i=m(t.geometry(),e.geometryType);const s=function(t,e){if(!e||0===e.length)return;const r=t.propertiesArray(),i=new DataView(r.buffer,r.byteOffset),s=t.propertiesLength();let n=0;const o={};for(;n<s;){const t=i.getUint16(n,!0);n+=2;const s=e[t];switch(s.type){case d.Bool:o[s.name]=!!i.getUint8(n),n+=1;break;case d.Byte:o[s.name]=i.getInt8(n),n+=1;break;case d.UByte:o[s.name]=i.getUint8(n),n+=1;break;case d.Short:o[s.name]=i.getInt16(n,!0),n+=2;break;case d.UShort:o[s.name]=i.getUint16(n,!0),n+=2;break;case d.Int:o[s.name]=i.getInt32(n,!0),n+=4;break;case d.UInt:o[s.name]=i.getUint32(n,!0),n+=4;break;case d.Long:o[s.name]=Number(i.getBigInt64(n,!0)),n+=8;break;case d.ULong:o[s.name]=Number(i.getBigUint64(n,!0)),n+=8;break;case d.Double:o[s.name]=i.getFloat64(n,!0),n+=8;break;case d.String:{const t=i.getUint32(n,!0);n+=4;const e=new TextDecoder;o[s.name]=e.decode(r.subarray(n,n+t)),n+=t;break}default:throw new Error("Unknown type")}}return o}(t,r),n={type:"Feature",geometry:i};return s&&(n.properties=s),n}const U=32,T=4;function L(t,e){e=Math.min(Math.max(+e,2),65535);let r=t,i=r;do{i+=r=Math.ceil(r/e)}while(1!==r);const s=i-t;return i*U+(s+s%2)*T}const O=4,N=8,P=new Uint8Array([102,103,98,2,102,103,98,0]);function V(t){const r=function(t){const e=t.features[0],r=e.properties;let i=null;r&&(i=Object.keys(r).map(t=>new o(t,function(t){if("boolean"==typeof t)return d.Bool;if("number"==typeof t)return t%1==0?d.Int:d.Double;if("string"==typeof t)return d.String;if(null===t)return d.String;throw new Error("Unknown type (value '".concat(t,"')"))}(r[t]))));const s=new Set;for(const r of t.features)s.add(e.geometry.type);return new g(B(e.geometry.type),i)}(t),i=function(t,r){const i=t.features.length,s=new e.Builder(0);let n=null;r.columns&&(n=l.createColumnsVector(s,r.columns.map(t=>(function(t,e){const r=t.createString(e.name);return f.start(t),f.addName(t,r),f.addType(t,e.type),f.end(t)})(s,t))));const o=s.createString("L1");l.start(s),l.addFeaturesCount(s,new e.Long(i,0)),l.addGeometryType(s,r.geometryType),l.addIndexNodeSize(s,0),n&&l.addColumns(s,n);l.addName(s,o);const a=l.end(s);return s.finishSizePrefixed(a),s.asUint8Array()}(t,r),s=t.features.map(t=>E(t,r)),n=s.map(t=>t.length).reduce((t,e)=>t+e),a=new Uint8Array(P.length+i.length+n);a.set(i,P.length);let b=P.length+i.length;for(const t of s)a.set(t,b),b+=t.length;return a.set(P),a}async function*C(t){const r="function"==typeof(i=t).slice?i:new n("function"==typeof i.read?i:i.getReader());var i;let s=await r.slice(8);if(!s.every((t,e)=>P[e]===t))throw new Error("Not a FlatGeobuf file");s=await r.slice(4);let a=new e.ByteBuffer(s);const b=a.readUint32(0);s=await r.slice(b),a=new e.ByteBuffer(s);const h=l.getRoot(a),u=h.featuresCount().toFloat64(),d=[];for(let t=0;t<h.columnsLength();t++){const e=h.columns(t);d.push(new o(e.name(),e.type()))}const f=new g(h.geometryType(),d),c=h.indexNodeSize();c>0&&await r.slice(L(u,c)+u*N);for(let t=0;t<u;t++){s=await r.slice(4);const t=(a=new e.ByteBuffer(s)).readUint32(0);s=await r.slice(t);const i=new Uint8Array(t+4);i.set(s,4),(a=new e.ByteBuffer(i)).setPosition(O);const n=y.getRoot(a);yield S(n,f)}}e.SIZE_PREFIX_LENGTH=4,e.Builder.prototype.finish=function(t,r,i){var s=!!i;if(r){var n=r;if(this.prep(this.minalign,e.SIZEOF_INT+e.FILE_IDENTIFIER_LENGTH+(s?e.SIZE_PREFIX_LENGTH:0)),n.length!=e.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+e.FILE_IDENTIFIER_LENGTH);for(var o=e.FILE_IDENTIFIER_LENGTH-1;o>=0;o--)this.writeInt8(n.charCodeAt(o))}this.prep(this.minalign,e.SIZEOF_INT+(s?e.SIZE_PREFIX_LENGTH:0)),this.addOffset(t),s&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},e.Builder.prototype.finishSizePrefixed=function(t,e){this.finish(t,e,!0)},t.deserialize=function(t){return function(t){if(!t.subarray(0,7).every((t,e)=>P[e]===t))throw new Error("Not a FlatGeobuf file");const r=new e.ByteBuffer(t),i=r.readUint32(P.length);r.setPosition(P.length+O);const s=l.getRoot(r),n=s.featuresCount().toFloat64(),a=[];for(let t=0;t<s.columnsLength();t++){const e=s.columns(t);a.push(new o(e.name(),e.type()))}const b=new g(s.geometryType(),a);let h=P.length+O+i;const u=s.indexNodeSize();u>0&&(h+=L(n,u)+n*N);const d=[];for(let r=0;r<n;r++){const r=new e.ByteBuffer(t),i=r.readUint32(h);r.setPosition(h+O);const s=y.getRoot(r);d.push(S(s,b)),h+=O+i}return{type:"FeatureCollection",features:d}}(t)},t.deserializeStream=function(t){return C(t)},t.serialize=function(t){return V(t)},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=flatgeobuf-geojson.min.js.map
